<!DOCTYPE html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!-- Consider adding a manifest.appcache: h5bp.com/d/Offline -->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    {% load i18n coffeescript compressed staticfiles %}

    <meta charset="utf-8">
    
    <!-- Use the .htaccess and remove these lines to avoid edge case issues.
         More info: h5bp.com/i/378 -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>{{ settings.INIT_PRODUCT_NAME }}&reg; - {% block title%}{% trans 'Main Page' %}{% endblock %}</title>
    <meta http-equiv="Cache-Control" content="max-age=28800, must-revalidate" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <!-- Mobile viewport optimized: h5bp.com/viewport -->
    <meta name="viewport" content="width=device-width"/>
    
    <!-- Place favicon.ico and apple-touch-icon.png in the root directory: mathiasbynens.be/notes/touch-icons -->

    {% block stylesheets %}
        {% compressed_css 'part1' %}
    <style type="text/css" media="screen">
    
        .dataTables_info { padding-top: 0; }
        .dataTables_paginate { padding-top: 0; }
        .css_right { float: right; }
    
    </style>
    
    <style type="text/css">
    
    .CodeMirror {
        border-top: 1px solid black;
        border-bottom: 1px solid black;
        height: auto;
    }
    
    .CodeMirror-scroll {
        overflow-y: hidden;
        overflow-x: auto;
        max-height: 600px;
    }
    
    .CodeMirror-activeline-background {
        background: #ffff00 !important;
    }
    
    </style>
    
    {% block tab_js %}{% endblock %}
    
    {% endblock %}
    {% block site_css %}
    {% endblock %}
    
    <!-- More ideas for your <head> here: h5bp.com/d/head-Tips -->
    
    <!-- All JavaScript at the bottom, except this Modernizr build.
         Modernizr enables HTML5 elements & feature detects for optimal performance.
         Create your own custom Modernizr build: www.modernizr.com/download/ -->
    {% block javascript %}
        <!--[if lt IE 9]>
            <script type="text/javascript" src='{% static "js/libs/modernizr-2.7.1.ie8.js" %}'></script>
            <script type="text/javascript" src='{% static "js/libs/jquery-1.11.1.js" %}'></script>
            <script type="text/javascript" src='{% static "js/plugins.js" %}'></script>
            <script type="text/javascript" src='{% static "js/libs/html5shiv.js" %}'></script>
        <![endif]-->
        <!--[if gte IE 9]><!-->{% compressed_js 'js_jquery_new' %}<!--<![endif]-->
        <script type="text/javascript">
        {% inlinecoffeescript %}
        # attach global permissions and license info to window object (== global variable)
        window.INIT_PRODUCT_NAME = "{{ settings.INIT_PRODUCT_NAME }}"
        window.CLUSTER_LICENSE = {{ CLUSTER_LICENSE | safe }}
        window.GLOBAL_PERMISSIONS = {{ GLOBAL_PERMISSIONS | safe }}
        window.OBJECT_PERMISSIONS = {{ OBJECT_PERMISSIONS | safe }}
        window.CURRENT_USER = {{ CURRENT_USER | safe }}
        window.NUM_BACKGROUND_JOBS = {{ NUM_BACKGROUND_JOBS }}
        window.SERVICE_TYPES = {{ SERVICE_TYPES | safe }}
        window.NUM_QUOTA_SERVERS = {{ NUM_QUOTA_SERVERS | safe }}
        window.INDEX_VIEW = {% if index_view %}true{% else %}false{% endif %}
        {% endinlinecoffeescript %}
        </script>
        {% compressed_js 'js_base' %}
        {% compressed_js 'js_extra1' %}
    
        {% include "javascript/init.js" %}
        {% include "javascript/deviceinfo.js" %}
        {# common angular modules #}
        {% include "angular/common_functions.cs" %}
        {% include "angular/tree.cs" %}
        {% include "angular/rrd.cs" %}
        {% include "angular/user.cs" %}
        {% include "angular/device_config.cs" %}
        {% include "angular/device_livestatus.cs" %}
        {% include "angular/device_graph.cs" %}
        {% include "angular/device_network.cs" %}
        {% include "angular/device_variable.cs" %}
        {# site-related javascript load blocks #}
        {% block js_load_1 %}{% endblock %}
        {# site-related angular modules #}
        {% block angular %}{% endblock %}
    {% endblock %}

</head>
<body>
    <!--[if lt IE 8]><p class=chromeframe>Your browser is <em>ancient!</em> <a href="http://browsehappy.com/">Upgrade to a different browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience this site.</p><![endif]-->
    <header>
    {% block header %}
    {% endblock %}
    </header>

    {% block main %}
    {% block body %}
    {% if user.is_authenticated %}
        <div class="ui-layout-north">
            {% include "menu.html" %}
        </div>
    {% endif %}
    <noscript>
        <p>no JavaScript, no Clustersoftware</p>
    </noscript>
    {% if not hide_sidebar %}
        <div class="ui-layout-west " >
            {% include 'sidebar.html' %}
        </div>
    {% endif %}
    <div class="ui-layout-center" id="pane-center">
        {% block content %}
        {% endblock %}
    </div>
    {% endblock %}
    {% endblock %}
    <footer>
        {% block footer %}
        
        <script type="text/javascript">
        
        {% inlinecoffeescript %}
        
        save_layout_state = (my_layout, p_name) ->
            call_ajax
                url  : "{% url 'user:save_layout_state' %}"
                data : 
                    my_layout.state
                    
        init_layout = ->
            if $("div.ui-layout-center").length
                my_layout = $("body").layout
                    applyDefaultStyles  : true
                    slidable            : false
                    spacing_open        : 6
                    spacing_closed      : 6
                    west__size          : 340
                    west__maxSize       : 480
                    west__minSize       : 100
                    east__size          : 300
                    east__maxSize       : 600
                    east__minSize       : 300
                    north__size         : 52
                    center_minWidth     : 200
                    north__spacing_open : 0
                    south__initClosed   : true
                    west__initClosed    : {% if request.session.west_closed %}true{% else %}false{% endif %}
                    east__initClosed    : true
                    onopen : (p_name) ->
                        save_layout_state(my_layout, p_name)
                    onclose : (p_name) ->
                        save_layout_state(my_layout, p_name)
                my_layout.panes.north.css("background-color", "#000000")
                my_layout.allowOverflow("north")
        
        init_blockUI = ->
            $.blockUI.defaults.fadeOut = 0
            $.blockUI.defaults.fadeIn  = 0
            $.blockUI.defaults.overlayCSS.opacity = 0.1
            
        init_noty = ->
            $.noty.defaults = {
                "layout" : "topRight"
                "theme"  : "defaultTheme"
                "type"   : 'success',
                "text"   : '',
                "dismissQueue" : true, # If you want to use queue feature set this true
                "template"     : '<div class="noty_message"><span class="noty_text"></span><div class="noty_close"></div></div>',
                "animation"    : {
                    open   : {height: 'toggle'},
                    close  : {height: 'toggle'},
                    easing : 'swing',
                    speed  : 200 # opening & closing animation speed
                },
                "timeout"   : 5000,  # delay for closing event. Set false for sticky notifications
                "force"     : false, # adds notification to the beginning of queue when set to true
                "modal"     : false,
                "closeWith" : ['hover'], # ['click', 'button', 'hover']
                "callback" : {
                    onShow     : ->
                    afterShow  : ->
                    onClose    : ->
                    afterClose : ->
                },
                buttons: false
            }
        add_handlers_main = ->
            init_layout()
            init_blockUI()
            init_noty()
        
        $(document).ready(add_handlers_main)
        
        {% endinlinecoffeescript %}
        
        </script>
        {% endblock %}
    </footer>

</body>
</html>
