<script type="text/ng-template" id="icsw/main/config/overview.html">
    <icsw-config-config-overview></icsw-config-config-overview>
</script>

<script type="text/ng-template" id="icsw/main/moncheck/overview.html">
    <icsw-config-moncheck-overview></icsw-config-moncheck-overview>
</script>

<script type="text/ng-template" id="icsw.config.config.overview">
    <div class="container-fluid">
        <uib-tabset>
            <uib-tab heading="Configurations">
                <icsw-config-config-table></icsw-config-config-table>
                <!-- removed temporarily due to CSW-576
                <icsw-config-uploader></icsw-config-uploader>
                -->
                <icsw-config-generate-config icsw-sel-man="0"></icsw-config-generate-config>
            </uib-tab>
            <uib-tab heading="Configuration Catalogs">
                <icsw-config-catalog-table></icsw-config-catalog-table>
            </uib-tab>
            <uib-tab heading="Monitoring Categories">
                <icsw-config-category-tree-edit mode="mon"></icsw-config-category-tree-edit>
            </uib-tab>
            <uib-tab heading="Configuration Categories">
                <icsw-config-category-tree-edit mode="config"></icsw-config-category-tree-edit>
            </uib-tab>
            <uib-tab heading="Uploads ({{ config_tree.uploaded_configs.length }})" ng-if="config_tree.uploaded_configs.length">
                <icsw-config-uploaded></icsw-config-uploaded>
            </uib-tab>
        </uib-tabset>
    </div>
</script>

<script type="text/ng-template" id="icsw.config.moncheck.overview">
    <div class="container-fluid">
        <uib-tabset>
            <uib-tab heading="Configurations">
                <icsw-config-mon-table></icsw-config-mon-table>
            </uib-tab>
            <uib-tab heading="Monitoring Categories">
                <icsw-config-category-tree-edit mode="mon"></icsw-config-category-tree-edit>
            </uib-tab>
        </uib-tabset>
    </div>
</script>

<script type="text/ng-template" id="config.catalog.form">
    <form name="form_data" class="form-horizontal">
        <fieldset>
            <legend>Basic Settings Configuration Catalog '{{ edit_obj.name }}'</legend>
            <div class="form-group  ng-class:form_error('name')">
                <label class="control-label col-sm-3 requiredField icsw-formlabel">
                    Name<span class="asteriskField">*</span>
                </label>
                <div class="controls col-sm-7">
                    <input class="textinput textInput form-control" maxlength="254" name="name" ng-model="edit_obj.name" required="True" type="text"/>
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-3 icsw-formlabel">
                    Author
                </label>
                <div class="controls col-sm-7">
                    <input class="textinput textInput form-control"maxlength="256" name="author" ng-model="edit_obj.author" type="text"/>
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-3 icsw-formlabel">
                    Url
                </label>
                <div class="controls col-sm-7">
                    <input class="urlinput form-control" maxlength="256" name="url" ng-model="edit_obj.url" type="url"/>
                </div>
            </div>
        </fieldset>
    </form>
</script>

<script type="text/ng-template" id="icsw.config.download">
    <icsw-tools-button type="download" value="download selected configs" ng-show="configTree.$selected" ng-click="download_selected()" size="xs"></icsw-tools-button>
</script>

<script type="text/ng-template" id="icsw.config.uploader">
    <div class="input-group">
        <label class="control-label">Upload Configuration</label><br/>
        <input type="file" class="btn btn-sm btn-primary form-control-inline" nv-file-select="" uploader="uploader"/>
        <icsw-tools-button type="upload" ng-show="uploader.queue.length" size="sm" value="upload" ng-click="uploader.uploadAll()"></icsw-tools-button>
    </div>
</script>

<script type="text/ng-template" id="icsw.config.uploaded">
    <div>
        <h3>
            <form class="form-inline">
                Upload to Catalog <select name="catalog" class="select form-control input-sm" ng-model="use_catalog" ng-options="value.idx as value.name for value in config_tree.catalog_list"></select>
            </form>
        </h3>
        <icsw-config-upload-info ng-repeat="entry in config_tree.uploaded_configs" config-tree="config_tree" upload="entry" catalog="use_catalog">
        </icsw-config-upload-info>
    </div>
</script>

<script type="text/ng-template" id="icsw.config.cached.upload.info">
    <div>
        <h3>upload {{ upload.upload_key }}, {{ upload.list.length }} configs</h3>
        <ul class="list-group">
            <li class="list-group-item" ng-repeat="config in upload.list">
                {{ config.name }} ({{ config.description }})
                <span class="label label-info" title="number of config vars">{{ get_num_vars(config) }}</span>
                <span class="label label-info" title="number of config script">{{ get_num_scripts(config) }}</span>
                <span class="label label-info" title="number of monitoring check commands">{{ get_num_check_commands(config) }}</span>
                <span class="pull-right">
                    <input type="button" ng-show="!config._taken" class="btn btn-xs btn-success" value="take" ng-click="take_config(config)"/>
                    <input type="button" ng-show="!config._taken" class="btn btn-xs btn-danger" value="delete" ng-click="delete_config(config)"/>
                    <span class="label label-warning" ng-show="config._taken">already taken</span>
                </span>
            </li>
        </ul>
    </div>
</script>

<script type="text/ng-template" id="icsw.config.config.table">
    <div uib-alert class="alert-warning" ng-if="!struct.data_valid">
        Loading Data ...
    </div>
    <div ng-if="struct.data_valid">
        <h3>
            {{ struct.config_tree.list.length }} Configurations, {{ struct.config_tree.filtered_list.length }} shown, {{ struct.config_tree.$selected }} selected
            <icsw-tools-button-static
                type="create"
                value="create new Configuration"
                ng-click="create_config($event)"
                size="xs"
            ></icsw-tools-button-static>
            <icsw-tools-button-static
                ng-show="struct.config_tree.$selected"
                type="clear"
                value="clear Selection"
                ng-click="clear_selection($event)"
                size="xs"
            ></icsw-tools-button-static>
            <icsw-tools-button-static
                ng-show="struct.config_tree.$selected"
                type="modify"
                value="modify Selection"
                ng-click="modify_selection($event)"
                size="xs"
            ></icsw-tools-button-static>
            <!-- removed temporarily due to bug in CSW-576
            <icsw-config-download config-tree="config_tree"></icsw-config-download>
            -->
        </h3>
        <uib-tabset active="struct.activetab">
            <uib-tab index="0">
                <uib-tab-heading>
                    Configuration List
                </uib-tab-heading>
                <table
                    st-table="configs_displayed"
                    st-safe-src="struct.config_tree.filtered_list"
                    class="table table-hover table-condensed table-striped"
                    style="width:100%;"
                >
                    <thead>
                        <tr>
                            <td colspan="99">
                                <div class="row">
                                    <div class="col-sm-3">
                                        <div class="input-group">
                                            <input
                                                ng-model="struct.search_str"
                                                ng-model-options="{debounce: {default: 200, blur: 0}}"
                                                ng-change="update_search()"
                                                class="form-control"
                                                placeholder="filter"
                                            >
                                            </input>
                                            <div class="input-group-btn">
                                                <input type="button" title="Add config to search scope" ng-class="struct.filter_settings.$$config_class" value="Name" ng-click="change_filter_setting($event, 'config')"/>
                                                <input type="button" title="Add script(s) to search scope" ng-class="struct.filter_settings.$$script_class" value="Script" ng-click="change_filter_setting($event, 'script')"/>
                                                <input type="button" title="Add variable(s) to search scope" ng-class="struct.filter_settings.$$var_class" value="Variable" ng-click="change_filter_setting($event, 'var')"/>
                                                <input type="button" title="Add monitoring config(s) to search scope" ng-class="struct.filter_settings.$$mon_class" value="MonCheck" ng-click="change_filter_setting($event, 'mon')"/>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-2">
                                        Service:
                                        <icsw-tools-tri-button
                                            icsw-state="struct.with_service"
                                            icsw-callback="change_boolean_filters('with_service', value)"
                                        ></icsw-tools-tri-button>
                                        Server:
                                        <icsw-tools-tri-button
                                            icsw-state="struct.with_server"
                                            icsw-callback="change_boolean_filters('with_server', value)"
                                        ></icsw-tools-tri-button>
                                    </div>
                                    <div
                                        icsw-tools-pagination
                                        st-items-by-page="15"
                                        st-displayed-pages="11"
                                        possible-items-by-page="15,30,100,200"
                                        class="col-sm-6"
                                    ></div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th st-sort="name">Name</th>
                            <th st-sort="priority">Priority</th>
                            <th class="text-center">Service</th>
                            <th>Flags</th>
                            <th st-sort="config_catalog">Catalog</th>
                            <th class="text-center">Enabled</th>
                            <th>Description</th>
                            <th class="text-center">Variables</th>
                            <th class="text-center">Scripts</th>
                            <th class="text-center">MonChecks</th>
                            <th>Categories</th>
                            <th colspan="2">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr icsw-config-line ng-repeat="config in configs_displayed" ng-class="config.$$config_line_class" ng-click="toggle_config_select($event, config)">
                        </tr>
                    </tbody>
                </table>
            </uib-tab>
            <uib-tab ng-repeat="config in struct.open_configs" index="config.tabindex">
                <uib-tab-heading>
                    {{ config.name }}
                    <span class="label label-danger" ng-show="changed(config)">Changed</span>
                    <icsw-tools-button size="xs" type="close" value="" ng-click="close_config($event, config)"></icsw-tools-button>
                </uib-tab-heading>
                <icsw-config-modify
                    icsw-config-tree="struct.config_tree"
                    icsw-config="config"
                ></icsw-config-modify>
            </uib-tab>
        </uib-tabset>
    </div>
</script>

<script type="text/ng-template" id="icsw.config.moncheck.table">
    <div uib-alert class="alert-warning" ng-if="!struct.data_valid">
        Loading Data ...
    </div>
    <div ng-if="struct.data_valid">
        <h3>
            {{ struct.config_tree.mcc_list.length }} Monitoringchecks, {{ struct.config_tree.filtered_mcc_list.length }} shown, {{ struct.config_tree.$mcc_selected }} selected
            <icsw-tools-button-static
                type="create"
                value="Create new Monitoring Check"
                ng-click="create_mon_check($event)"
                size="xs"
            ></icsw-tools-button-static>
            <!-- <icsw-tools-button-static
                ng-show="struct.config_tree.$selected"
                type="clear"
                value="clear selection"
                ng-click="clear_selection($event)"
                size="xs"
            ></icsw-tools-button-static>
            <icsw-tools-button-static
                ng-show="struct.config_tree.$selected"
                type="modify"
                value="modify selection"
                ng-click="modify_selection($event)"
                size="xs"
            ></icsw-tools-button-static> -->
        </h3>
        <uib-tabset active="struct.active_tab">
            <uib-tab index="0">
                <uib-tab-heading>
                    Check List
                </uib-tab-heading>
                <table
                    st-table="monccs_displayed"
                    st-safe-src="struct.config_tree.filtered_mcc_list"
                    class="table table-hover table-condensed table-striped"
                    style="width:100%;"
                >
                    <thead>
                        <tr>
                            <td colspan="99">
                                <div class="row">
                                    <div class="col-sm-3">
                                        <div class="input-group">
                                            <input
                                                ng-model="struct.search_str"
                                                ng-model-options="{debounce: {default: 200, blur: 0}}"
                                                ng-change="update_search()"
                                                class="form-control"
                                                placeholder="filter"
                                            >
                                            </input>
                                        </div>
                                    </div>
                                    <div
                                        icsw-tools-pagination
                                        st-items-by-page="30"
                                        st-displayed-pages="11"
                                        possible-items-by-page="15,30,100,200"
                                        class="col-sm-6"
                                    ></div>
                                </div>
                            </td>
                        </tr>
                        <tr icsw-mon-check-command-header></tr>
                    </thead>
                    <tbody>
                        <tr icsw-mon-check-command-line ng-repeat="obj in monccs_displayed">
                        </tr>
                    </tbody>
                </table>
            </uib-tab>
        </uib-tabset>
    </div>
</script>

<script type="text/ng-template" id="icsw.config.modify.form">
    <form class="form-horizontal" name="form_data" ng-if="struct.data_ready">
        <h3>Configuration '{{ edit_obj.name }}'</h3>
        <div class="row">
            <div class="col-md-6 col-xs-6">
                <fieldset>
                    <legend>Basic settings</legend>
                    <div class="form-group ng-class:form_error('name')">
                        <label class="control-label col-sm-3 requiredField icsw-formlabel">
                            Name<span class="asteriskField">*</span>
                        </label>
                        <div class="controls col-sm-7">
                            <input
                                class="textinput textInput form-control maxwidth500"
                                maxlength="192"
                                name="name"
                                ng-model="edit_obj.name"
                                type="text"
                                autocomplete="off"
                                uib-typeahead="hint for hint in config_tree.config_hint_names | filter:$viewValue"
                                typeahead-min-length="1"
                                typeahead-on-select="config_tree.config_selected_vt($item, $model, $label, config)"
                                ng-blur="config_tree.check_config_hint(edit_obj)"
                            />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3 icsw-formlabel">
                            Description
                        </label>
                        <div class="controls col-sm-7">
                            <input class="textinput textInput form-control maxwidth500" maxlength="765" name="description" ng-model="edit_obj.description" type="text"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3 icsw-formlabel">
                            Configuration Service
                        </label>
                        <div class="controls col-sm-7">
                            <div class="input-group">
                                <ui-select ng-model="edit_obj.config_service_enum" class="maxwidth500">
                                    <ui-select-match class="ui-select-match" placeholder="select Config Service">
                                        {{ $select.selected.name }}
                                    </ui-select-match>
                                    <ui-select-choices class="ui-select-choices" repeat="value.idx as value in config_tree.cse_list | props_filter:{$$info_str:$select.search}">
                                        <div ng-bind-html="value.$$info_str | highlight: $select.search"></div>
                                    </ui-select-choices>
                                </ui-select>
                                <span class="input-group-btn">
                                    <button type="button" ng-click="edit_obj.config_service_enum = null" class="btn btn-default">
                                        <span class="glyphicon glyphicon-trash"></span>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </div>
                </fieldset>
                <!-- FIXME <div ng-bind-html="config.$$config_help_html"></div> -->
                <fieldset>
                    <legend>Other Settings</legend>
                    <div class="form-group">
                        <label class="col-sm-3 control-label icsw-formlabel">
                            Enabled
                        </label>
                        <div class="col-sm-7 controls">
                            <icsw-tools-yes-no flag="edit_obj.enabled"></icsw-tools-yes-no>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3 requiredField icsw-formlabel">
                            Priority<span class="asteriskField">*</span>
                        </label>
                        <div class="controls col-sm-7">
                            <input class="numberinput form-control maxwidth500" type="number" name="priority" ng-model="edit_obj.priority" required="True" type="number" value="0"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3 requiredField icsw-formlabel">
                            Configuration Catalog<span class="asteriskField">*</span>
                        </label>
                        <div class="controls col-sm-7">
                            <ui-select ng-model="edit_obj.config_catalog" class="maxwidth500">
                                <ui-select-match class="ui-select-match" placeholder="select config catalog">
                                    {{ $select.selected.$$info_str }}
                                </ui-select-match>
                                <ui-select-choices class="ui-select-choices" repeat="value.idx as value in config_tree.catalog_list | props_filter:{$$info_str:$select.search}">
                                    <div ng-bind-html="value.$$info_str | highlight: $select.search"></div>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                    </div>
                    <div class="form-group" ng-show="!edit_obj.system_config">
                        <label class="col-sm-3 control-label icsw-formlabel">
                            Server Configuration
                        </label>
                        <div class="col-sm-7 controls">
                            <icsw-tools-yes-no flag="edit_obj.server_config"></icsw-tools-yes-no>
                        </div>
                    </div>
                </fieldset>
            </div>
            <div class="col-md-6 col-xs-6">
                <fieldset ng-if="!create_mode">
                    <legend>Categories</legend>
                    <icsw-config-category-tree-select
                        edit-obj="edit_obj"
                        icsw-sub-tree="'config'"
                        icsw-mode="obj"
                    ></icsw-config-category-tree-select>
                </fieldset>
            </div>
        </div>
        <fieldset>
            <legend>Actions</legend>
            <div class="form-actions pull-right" style="margin-bottom:15px;">
                <icsw-tools-button type="delete" ng-show="!create_mode" ng-click="delete_config()"></icsw-tools-button>
                &nbsp;
                <icsw-tools-button type="close" ng-click="close_config()"></icsw-tools-button>
                &nbsp;
                <icsw-tools-button type="modify" ng-show="!create_mode && changed()" ng-click="modify()"></icsw-tools-button>
                <icsw-tools-button type="create" ng-show="create_mode" ng-click="modify()"></icsw-tools-button>
            </div>

        </fieldset>
        <fieldset ng-if="!create_mode">
            <legend>Variables, Configuration Scripts and Monitoring Check Commands</legend>
            <uib-tabset>
                <uib-tab>
                    <uib-tab-heading>
                        <!-- we use config here because edit_obj is a shallow copy for undo -->
                        Variables ({{ config.$$num_var }})
                        <icsw-tools-button-static size="xs" type="create" value="str" ng-click="create_var($event, config, 'str')"></icsw-tools-button-static>
                        <icsw-tools-button-static size="xs" type="create" value="int" ng-click="create_var($event, config, 'int')"></icsw-tools-button-static>
                        <icsw-tools-button-static size="xs" type="create" value="bool" ng-click="create_var($event, config, 'bool')"></icsw-tools-button-static>
                    </uib-tab-heading>
                    <icsw-config-var-table config="config" config-tree="config_tree"><</icsw-config-var-table>
                </uib-tab>
                <uib-tab>
                    <uib-tab-heading>
                        Scripts ({{ config.$$num_script }})
                        <icsw-tools-button-static size="xs" type="create" value="script" ng-click="create_script($event, config)"></icsw-tools-button-static>
                    </uib-tab-heading>
                    <icsw-config-script-table config="config" config-tree="config_tree"></icsw-config-script-table>
                </uib-tab>
                <uib-tab>
                    <uib-tab-heading>
                        Monitoring Checks ({{ config.$$num_mon }})
                        <icsw-tools-button-static
                            ng-if="struct.mon_tree"
                            size="xs"
                            type="create"
                            value="MonCheck"
                            ng-click="create_mon_check_command($event, config)"
                        ></icsw-tools-button-static>
                    </uib-tab-heading>
                    <icsw-config-mon-table
                        icsw-config="config"
                        icsw-config-tree="config_tree"
                    ></icsw-config-mon-table>
                </uib-tab>
            </uib-tabset>
        </fieldset>
    </form>
</script>

<script type="text/ng-template" id="icsw.config.catalog.table">
    <div ng-if="struct.data_present">
        <h3>{{ struct.config_tree.catalog_list.length }} Catalogs
            <icsw-tools-button-static type="create" value="create new Catalog" ng-click="create_or_edit($event, true, null)" size="xs"></icsw-tools-button-static>
        </h3>
        <table
            st-table="entries_displayed"
            st-safe-src="struct.config_tree.catalog_list"
            class="table table-hover table-condensed table-striped"
            style="width:auto;"
        >
            <thead>
                <tr>
                    <th st-sort="name">Name</th>
                    <th class="text-center">System Configuration</th>
                    <th st-sort="url">URL</th>
                    <th st-sort="author">Author</th>
                    <th class="text-right">Version</th>
                    <th class="text-center">Priority</th>
                    <th class="text-right">#Configurations</th>
                    <th colspan="2">Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="catalog in entries_displayed">
                    <td>{{ catalog.name }}</td>
                    <td class="text-center"><span ng-bind-html="catalog.system_catalog | yesno3"></span></td>
                    <td>{{ catalog.url }}</td>
                    <td>{{ catalog.author }}</td>
                    <td class="text-right">{{ catalog.version }}</td>
                    <td class="text-cneter">{{ catalog.priority }}</td>
                    <td class="text-center">{{ catalog.configs.length }}</td>
                    <td>
                        <icsw-tools-button-static type="modify" value="modify" ng-click="create_or_edit($event, false, catalog)" size="xs"/>
                    </td>
                    <td>
                        <icsw-tools-button-static type="delete" value="delete" ng-show="catalog.configs.length == 0" ng-click="delete($event, catalog)" size="xs"/>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</script>

<script type="text/ng-template" id="icsw.config.line">
    <td>
        <span ng-show="config.$hint" class="pull-right">
            <span class="glyphicon glyphicon-info-sign" title="{{ config.$$config_help_text }}">
            </span>
        </span>
        {{ config.name }}
    </td>
    <td>{{ config.priority }}</td>
    <td class="text-center">
        <span ng-show="config.$$cse">
            <span class="label label-success">{{ config.$$cse.name }}</span>
        </span>
    </td>
    <td>
        <span class="label label-success" ng-show="config.server_config" uib-tooltip="is a server config">S</span>
        <span class="label label-default" ng-show="!config.server_config" uib-tooltip="not a server config">s</span>
    </td>
    <td>{{ config.$$catalog_name }}</td>
    <td class="text-center">
        <span ng-bind-html="config.enabled | yesno4"></span>
    </td>
    <td>{{ config.description }}</td>
    <td class="text-center">
        <span ng-class="config.$$var_label_class">
            {{ config.$$var_span_str }}
        </span>
    </td>
    <td class="text-center">
        <span ng-class="config.$$script_label_class">
            {{ config.$$script_span_str }}
        </span>
    </td>
    <td class="text-center">
        <span ng-class="config.$$mon_label_class">
            {{ config.$$mon_span_str }}
        </span>
    </td>
    <td>{{ config.$$cat_info_str }}</td>
    <td>
        <icsw-tools-button-static type="modify" value="modify" ng-click="modify_config($event, config, false)" size="xs"/>
    </td>
    <td class="text-center">
        <span ng-if="config.$$usecount" class="text-warning">
            used: {{ config.$$usecount }}
        </span>
        <span ng-if="!config.$$usecount">
            <icsw-tools-button-static type="delete" value="delete" ng-click="delete_config($event, config)" size="xs"/>
        </span>
    </td>
</script>

<script type="text/ng-template" id="icsw.config.var.table">
    <icsw-tools-rest-table-new target-list="vars" config-service="icswConfigVarListService">
        <table
            st-table="vars_displayed"
            st-safe-src="vars"
            class="table table-hover table-condensed table-striped"
            style="width:100%;"
        >
            <thead>
                <tr>
                    <td colspan="99">
                        <div class="row">
                            <div class="col-sm-5">
                                <div class="input-group">
                                    <input st-search="" class="form-control" placeholder="filter">
                                    </input>
                                </div>
                            </div>
                            <div
                                icsw-tools-pagination
                                st-items-by-page="15"
                                st-displayed-pages="11"
                                possible-items-by-page="15,30,100,200"
                                class="col-sm-7"
                            ></div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th st-sort="name">Name</th>
                    <th st-sort="value">value</th>
                    <th st-sort="description">description</th>
                    <th class="text-center">type</th>
                    <th colspan="2">Action</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="obj in vars_displayed">
                    <td>
                        <span ng-show="config_service.var_has_info(config, obj)" class="pull-right">
                            <span class="glyphicon glyphicon-info-sign" title="{{ config_service.get_var_help_text(config, obj) }}">
                            </span>
                        </span>
                        {{ obj.name }}
                    </td>
                    <td>{{ config_service.get_value(obj) }}</td>
                    <td>{{ obj.description }}</td>
                    <td class="text-center">{{ obj.$var_type }}</td>
                    <td><input type="button" ng-class="obj.$selected && 'btn btn-primary btn-xs' || 'btn btn-xs btn-default'" value="sel" ng-click="config_service.select(obj)"/>
                    <td><icsw-tools-button-static type="modify" value="modify" ng-click="edit($event, obj)" size="xs"/></td>
                    <td><icsw-tools-button-static type="delete" value="delete" ng-click="delete($event, obj)" size="xs"/></td>
                </tr>
            </tbody>
        </table>
    </icsw-tools-rest-table-new>
</script>

<script type="text/ng-template" id="icsw.config.script.table">
    <icsw-tools-rest-table-new target-list="scripts" config-service="icswConfigScriptListService">
        <table st-table="scripts_displayed" st-safe-src="scripts"
               class="table table-condensed table-hover" style="width:100%;">
            <thead>
                <tr>
                    <td colspan="99">
                        <div class="row">
                            <div class="col-sm-5">
                                <div class="input-group">
                                    <input st-search="" class="form-control" placeholder="filter">
                                    </input>
                                </div>
                            </div>
                            <div
                                icsw-tools-pagination
                                st-items-by-page="15"
                                st-displayed-pages="11"
                                possible-items-by-page="15,30,100,200"
                                class="col-sm-7"
                            ></div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th st-sort="name">Name</th>
                    <th>Value</th>
                    <th st-sort="description">Description</th>
                    <th>Priority</th>
                    <th>Enabled</th>
                    <th colspan="2">Action</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="obj in scripts_displayed">
                    <td>{{ obj.name }}</td>
                    <td style="font-family:monospace; width:480px;">
                        <textarea ng-model="obj.value" class="form-control input-sm" rows="5" readonly>
                        </textarea>
                    </td>
                    <td>{{ obj.description }}</td>
                    <td>{{ obj.priority }}</td>
                    <td>{{ obj.enabled | yesno1 }}</td>
                    <td><input type="button" ng-class="obj.$selected && 'btn btn-primary btn-xs' || 'btn btn-xs btn-default'" value="sel" ng-click="config_service.select(obj)"/></td>
                    <td><icsw-tools-button-static type="modify" value="modify" ng-click="edit($event, obj)" size="xs"></icsw-tools-button-static></td>
                    <td><icsw-tools-button-static type="delete" value="delete" ng-click="delete($event, obj)" size="xs"></icsw-tools-button-static></td>
                </tr>
            </tbody>
        </table>
    </icsw-tools-rest-table-new>
</script>

<script type="text/ng-template" id="icsw.config.mon.table">
    <div>
        <div uib-alert class="alert-warning" ng-if="!struct.data_loaded">
            Loading Data ...
        </div>
        <div ng-if="struct.data_loaded">
            <h3 ng-show="!struct.is_sub_table">
                {{ struct.config_tree.mcc_list.length }} Monitoringchecks, {{ struct.config_tree.filtered_mcc_list.length }} shown, {{ struct.config_tree.$mcc_selected }} selected
                <icsw-tools-button-static
                    type="create"
                    value="Create new Monitoring Check"
                    ng-click="create_mon_check($event)"
                    size="xs"
                ></icsw-tools-button-static>

            </h3>
            <table
                st-table="monccs_displayed"
                st-safe-src="struct.monccs_list"
                st-trigger-redraw="struct.redraw_table"
                class="table table-condensed table-hover"
                style="width:100%;"
            >
                <thead>
                    <tr>
                        <td colspan="99">
                            <div class="row">
                                <div class="col-sm-3" style="width:250px;">
                                    <div class="input-group">
                                        <input st-search="" class="form-control" placeholder="filter">
                                        </input>
                                    </div>
                                </div>
                                <div
                                    icsw-tools-pagination
                                    st-items-by-page="30"
                                    st-displayed-pages="11"
                                    possible-items-by-page="15,30,100,200"
                                    class="col-sm-7"
                                    style="width:350px;"
                                ></div>
                            </div>
                        </td>
                    </tr>
                    <tr icsw-mon-check-command-header></tr>
                </thead>
                <tbody>
                    <tr icsw-mon-check-command-line ng-repeat="obj in monccs_displayed">
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</script>

<script type="text/ng-template" id="icsw.mon.check.command.header">
    <th st-sort="name">Name</th>
    <th st-sort="$$config_name">Config</th>
    <th>Template</th>
    <th st-sort="description">Description</th>
    <th>System</th>
    <th>Special</th>
    <th>Command Line</th>
    <!-- <th>active</th> -->
    <th>Vol</th>
    <th>Perf</th>
    <th>Is Event</th>
    <th>Event Handler</th>
    <th>EH Enabled</th>
    <th>Categories</th>
    <th colspan="4">Actions</th>
</script>

<script type="text/ng-template" id="icsw.mon.check.command.line">
    <td>{{ obj.name }}</td>
    <td>{{ obj.$$config_name || "---" }}</td>
    <td>{{ obj.$$mon_service_templ_name }}</td>
    <td>{{ obj.description }}</td>
    <td class="text-center"><span ng-bind-html="obj.system_command | yesno3"></span></td>
    <td class="text-center"><span ng-bind-html="obj.mon_check_command_special | yesno3"></span></td>
    <td title="{{ obj.$$command_line }}" ng-if="obj.is_active">
        <input
            type="button"
            title="expand / collapse full command line"
            ng-class="obj._show_full_command && 'btn btn-xs btn-success' || 'btn btn-xs btn-default'"
            value="e" ng-click="obj._show_full_command = !obj._show_full_command">
        </input>
        <span ng-if="!obj._show_full_command">{{ obj.$$command_line | limit_text:40:true }}</span>
        <span ng-if="obj._show_full_command">{{ obj.$$command_line }}</span>
    </td>
    <td title="{{ obj.$$command_line }}" ng-if="!obj.is_active">
        Passive check
    </td>
    <td class="text-center"><span ng-bind-html="obj.volatile | yesno3"></span></td>
    <td class="text-center"><span ng-bind-html="obj.enable_perfdata | yesno3"></span></td>
    <td class="text-center"><span ng-bind-html="obj.is_event_handler | yesno3"></span></td>
    <td>{{ obj.$$event_handler }}</td>
    <td class="text-center"><span ng-bind-html="obj.event_handler_enabled | yesno3"></span></td>
    <td class="text-center">{{ obj.categories.length || '-' }}</td>
    <td>
        <input
            ng-if="!obj.system_command"
            type="button"
            ng-class="obj.$selected && 'btn btn-primary btn-xs' || 'btn btn-xs btn-default'"
            value="sel"
            ng-click="select($event, obj)"
        />
    </td>
    <td>
        <icsw-tools-button-static
            ng-if="!obj.system_command"
            type="modify"
            value="modify"
            ng-click="edit($event, obj)"
            size="xs"
        ></icsw-tools-button-static>
    </td>
    <!-- <td>
        <icsw-tools-button-static
            ng-if="!obj.system_command"
            type="duplicate"
            ng-click="duplicate($event, obj)"
            size="xs"
        ></icsw-tools-button-static>
    </td> -->
    <td>
        <icsw-tools-button-static
            ng-if="!obj.system_command"
            type="delete"
            value="delete"
            ng-click="delete($event, obj)"
            size="xs"
        ></icsw-tools-button-static>
    </td>
</script>

<script type="text/ng-template" id="icsw.config.generate.config">
    <div ng-show="has_valid_license('netboot')">
        <input type="button" class="btn btn-info btn-sm" value="Show Device Configuration" ng-show="devsel_list.length" ng-click="generate_config()"/>
        <span ng-show="devsel_list.length">
            <!--for {{ dev_names() }} -->
        </span>
        <div ng-show="result_trees.length">
            <uib-tabset>
                <uib-tab ng-repeat="dev_conf in result_trees" heading="{{ dev_conf.name }}">
                    <h4><span ng-class="get_info_class(dev_conf)">{{ dev_conf.info_str }}</span></h4>
                    <div class="row">
                        <div class="col-md-5">
                            <icsw-react-tree icsw-tree-config="dev_conf.tree"></icsw-react-tree>
                        </div>
                        <div class="col-md-7">
                            <div ng-show="dev_conf.active_error.length">
                                <h4>Error Detail ({{ dev_conf.active_error.length}} lines)</h4>
                                <div style="font-family:monospace;">
                                    <span ng-repeat="line in dev_conf.active_error track by $index">
                                        <strong>{{ $index + 1 }} : </strong>{{ line }}<br>
                                    </span>
                                </div>
                            </div>
                            <div ng-show="dev_conf.active_content.length">
                                <h4>Content Detail ({{ dev_conf.active_content.length}} lines)</h4>
                                <div style="font-family:monospace;">
                                    <span ng-repeat="line in dev_conf.active_content track by $index">
                                        <strong>{{ $index + 1 }} : </strong>{{ line }}<br>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </uib-tab>
            </uib-tabset>
        </div>
    </div>
</script>

<script type="text/ng-template" id="icsw.mon.check.command.form">
    <form class="form-horizontal" name="form_data">
        <h3>Check command '{{ edit_obj.name }}'</h3>
        <uib-tabset>
            <uib-tab heading="Basic setup">
                <fieldset>
                    <legend>Basic Settings</legend>
                    <div class="form-group" ng-if="!fixed_config">
                        <label class="control-label col-sm-3 icsw-formlabel">
                            Configuration
                        </label>

                        <div class="controls col-sm-9">
                            <div class="input-group">
                                <ui-select ng-model="edit_obj.config" ng-disabled="false">
                                    <ui-select-match class="ui-select-match" placeholder="Please select a Configuration">
                                        {{ $select.selected.name }}
                                    </ui-select-match>
                                    <ui-select-choices
                                        class="ui-select-choices"
                                        repeat="value.idx as value in config_tree.list | props_filter:{name:$select.search}" group-by="'group'">
                                        <div ng-bind-html="value.name | highlight: $select.search"></div>
                                    </ui-select-choices>
                                </ui-select>
                                <span class="input-group-btn">
                                    <button type="button" ng-click="edit_obj.config = null" class="btn btn-default">
                                        <span class="glyphicon glyphicon-trash"></span>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="form-group  ng-class:form_error('name')">
                        <label class="control-label col-sm-3 requiredField icsw-formlabel">
                            Name<span class="asteriskField">*</span>
                        </label>

                        <div class="controls col-sm-9">
                            <input class="textinput textInput form-control maxwidth500" maxlength="192" name="name" ng-model="edit_obj.name" required="True" type="text"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3 icsw-formlabel">
                            Description
                        </label>

                        <div class="controls col-sm-9">
                            <input class="textinput textInput form-control maxwidth500" maxlength="192" name="description" ng-model="edit_obj.description" type="text"/>
                        </div>
                    </div>
                    <div class="form-group" ng-show="edit_obj.is_active">
                        <label class="control-label col-sm-3 icsw-formlabel">
                            Special MonCheck Command
                        </label>

                        <div class="controls col-sm-9">
                            <div class="input-group">
                                <ui-select ng-model="edit_obj.mon_check_command_special" ng-disabled="false">
                                    <ui-select-match class="ui-select-match" placeholder="Please select a Special Command">
                                        {{$select.selected.info}}
                                    </ui-select-match>
                                    <ui-select-choices class="ui-select-choices" repeat="value.idx as value in mccs_list | props_filter:{name:$select.search}" group-by="'group'">
                                        <div ng-bind-html="value.info | highlight: $select.search"></div>
                                    </ui-select-choices>
                                </ui-select>
                                <span class="input-group-btn">
                                    <button type="button" ng-click="edit_obj.mon_check_command_special = null" class="btn btn-default">
                                        <span class="glyphicon glyphicon-trash"></span>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="alert alert-danger" role="alert" ng-show="get_mccs_already_used_warning(edit_obj)">
                        <span class="glyphicon glyphicon-exclamation-sign"></span>
                        {{ get_mccs_already_used_warning(edit_obj) }}
                    </div>
                    <div class="form-group" ng-if="!edit_obj.mon_check_command_special && edit_obj.is_active">
                        <label class="control-label col-sm-3 requiredField icsw-formlabel">
                            Command Line<span class="asteriskField">*</span>
                        </label>

                        <div class="controls col-sm-9">
                            <input class="textinput textInput form-control" maxlength="765" name="command_line" ng-model="edit_obj.command_line" required="True" type="text"/>
                        </div>
                    </div>
                    <div class="form-group" ng-show="edit_obj.mon_check_command_special">
                        <label class="control-label col-sm-3 icsw-formlabel">Info</label>

                        <div class="col-sm-9 list-group">
                            <ul>
                                <li class="list-group-item">{{ get_mccs_info(edit_obj) }}</li>
                                <li class="list-group-item">{{ get_mccs_cmdline(edit_obj) }}</li>
                            </ul>
                        </div>
                    </div>
                    <div class="form-group" ng-show="!edit_obj.mon_check_command_special && edit_obj.is_active">
                        <label class="control-label col-sm-3 icsw-formlabel">Tools</label>

                        <div class="controls col-sm-9">
                            <div class="form-inline">
                                <input type="button" ng-class='"btn btn-sm btn-primary"' ng-click="add_argument(edit_obj)" ng-value='"add argument"'/>
                                Name:
                                <input type="text" class="form-control input-sm" title="default value" ng-model="edit_obj.arg_name"/>
                                Value:
                                <input type="text" class="form-control input-sm" title="default value" ng-model="edit_obj.arg_value"/>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" ng-show="!edit_obj.mon_check_command_special && edit_obj.is_active">
                        <label class="control-label col-sm-3 icsw-formlabel">Information</label>
                        <div class="col-sm-9 list-group">
                            <ul>
                                <li class="list-group-item" ng-repeat="value in get_moncc_info(edit_obj)">
                                    {{ value }}
                                </li>
                            </ul>
                        </div>
                    </div>
                </fieldset>
                <fieldset>
                    <legend>Additional Settings</legend>
                    <div class="form-group">
                        <label class="control-label col-sm-3 icsw-formlabel">
                            Monitoring Service Template
                        </label>
                        <div class="controls col-sm-9">
                            <div class="input-group">
                                <ui-select ng-model="edit_obj.mon_service_templ" ng-disabled="false">
                                    <ui-select-match class="ui-select-match" placeholder="please select a service template">
                                        {{ $select.selected.name }}
                                    </ui-select-match>
                                    <ui-select-choices class="ui-select-choices" repeat="value.idx as value in template_list | orderBy:'name' | props_filter:{name:$select.search}">
                                        <div ng-bind-html="value.name | highlight: $select.search"></div>
                                    </ui-select-choices>
                                </ui-select>
                                <span class="input-group-btn">
                                    <button type="button" ng-click="edit_obj.mon_service_templ = null" class="btn btn-default">
                                        <span class="glyphicon glyphicon-trash"></span>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" ng-show="!edit_obj.is_event_handler && get_event_handlers(edit_obj).length">
                        <label class="control-label col-sm-3 icsw-formlabel">
                            Event Handler
                        </label>

                        <div class="controls col-sm-9">
                            <div class="input-group">
                                <ui-select ng-model="edit_obj.event_handler" ng-disabled="false">
                                    <ui-select-match class="ui-select-match" placeholder="please select an event handler">
                                        {{ $select.selected.name }}
                                    </ui-select-match>
                                    <ui-select-choices class="ui-select-choices" repeat="value.idx as value in get_event_handlers(edit_obj)| props_filter:{name:$select.search}">
                                        <div ng-bind-html="value.name | highlight: $select.search"></div>
                                    </ui-select-choices>
                                </ui-select>
                                <span class="input-group-btn"><button type="button" ng-click="edit_obj.event_handler = null" class="btn btn-default"><span class="glyphicon glyphicon-trash"></span></button> </span>
                            </div>
                        </div>
                    </div>
                </fieldset>
                <fieldset ng-show="!edit_obj.mon_check_command_special && !edit_obj.is_event_handler">
                    <legend>Active / Passive Settings</legend>
                    <div class="form-group">
                        <div class="">
                            <div class="controls col-sm-9">
                                <label>
                                    <icsw-tools-yes-no-small flag="edit_obj.is_active"></icsw-tools-yes-no-small>
                                    Is Active
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group col-sm-12" ng-show="!edit_obj.is_active"><b>Set Result via</b></div>
                    <div class="form-group col-sm-12" ng-show="!edit_obj.is_active">
                        <code>
                        /opt/cluster/bin/set_passive_checkresult.py --device &lt;FQDN&gt; --check {{ edit_obj.name }}
                        --state {OK|WARN|CRITICAL} --output &lt;OUTPUT&gt;
                        </code>
                    </div>
                </fieldset>
                <fieldset>
                    <legend>Flags</legend>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <div class="">
                                    <div class="controls col-sm-9">
                                        <label>
                                            <icsw-tools-yes-no-small flag="edit_obj.volatile"></icsw-tools-yes-no-small>
                                            Volatile
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="">
                                    <div class="controls col-sm-9">
                                        <label>
                                            <icsw-tools-yes-no-small flag="edit_obj.enable_perfdata"></icsw-tools-yes-no-small>
                                            Enable Perfdata
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <div class="">
                                    <div class="controls col-sm-9">
                                        <label>
                                            <icsw-tools-yes-no-small flag="edit_obj.event_handler_enabled"></icsw-tools-yes-no-small>
                                            Event Handler Enabled
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="" ng-show="edit_obj.event_handler == undefined">
                                    <div class="controls col-sm-9">
                                        <label>
                                            <icsw-tools-yes-no-small flag="edit_obj.is_event_handler"></icsw-tools-yes-no-small>
                                            Is Event Handler
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </fieldset>
            </uib-tab>
            <uib-tab heading="Categories" ng-if="!create">
                <fieldset>
                    <legend>Categories</legend>
                    <icsw-config-category-tree-select
                        edit-obj="edit_obj"
                        icsw-sub-tree="'mon'"
                        icsw-mode="obj"
                    ></icsw-config-category-tree-select>
                </fieldset>
            </uib-tab>
            <uib-tab heading="History" ng-if="!create">
                <icsw-history-model-history style="config" icsw-model="'mon_check_command'" icsw-object-id="edit_obj.idx">
                </icsw-history-model-history>
            </uib-tab>
        </uib-tabset>
    </form>
</script>

<script type="text/ng-template" id="icsw.config.script.form">
    <form class="form-horizontal" name="form_data">
        <h3>Configure Script '{{ edit_obj.name }}'</h3>
        <uib-tabset>
            <uib-tab heading="Settings">
                <fieldset>
                    <legend>Basic Settings</legend>
                    <div class="form-group  ng-class:form_error('name')">
                        <label class="control-label col-sm-2 requiredField icsw-formlabel">
                            Name<span class="asteriskField">*</span>
                        </label>
                        <div class="controls col-sm-9">
                            <input class="textinput textInput form-control" maxlength="192" name="name" ng-model="edit_obj.name" required="True" type="text"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-2 icsw-formlabel">
                            Description
                        </label>
                        <div class="controls col-sm-9">
                            <input class="textinput textInput form-control" maxlength="765" name="description" ng-model="edit_obj.description" type="text"/>
                        </div>
                    </div>
                </fieldset>
                <fieldset>
                    <legend>Script</legend>
                    <div ui-ace="ace_options" ng-model="edit_obj.value"></div>
                </fieldset>
                <fieldset>
                    <legend>Flags</legend>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="control-label col-sm-2 icsw-formlabel">
                                    Priority
                                </label>
                                <div class="controls col-sm-5">
                                    <input class="numberinput form-control" name="priority" ng-model="edit_obj.priority" type="number" value="0"/>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <div class="checkbox">
                                    <div class="controls col-lg-offset-0 col-sm-9">
                                        <label>
                                            <input checked="checked" class="checkboxinput checkbox" name="enabled" ng-model="edit_obj.enabled" type="checkbox"/>
                                            Enabled
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </fieldset>
            </uib-tab>
            <uib-tab heading="History" ng-if="!create">
                <icsw-history-model-history on-revert="on_script_revert(edit_obj, get_change_list)" style="config" icsw-model="'config_script'" icsw-object-id="edit_obj.idx"></icsw-history-model-history>
            </uib-tab>
        </uib-tabset>
    </form>
</script>

<script type="text/ng-template" id="icsw.config.strintbool.form">
    <form class="form-horizontal" name="form_data">
        <h3>{{ long_var_type_name }} Variable '{{ edit_obj.name }}'</h3>
        <uib-tabset>
            <uib-tab heading="Settings">
                <fieldset style="margin-top:15px;">

                    <div class="form-group  ng-class:form_error('name')">
                        <label class="control-label col-sm-3 requiredField icsw-formlabel">
                            Name<span class="asteriskField">*</span>
                        </label>
                        <div class="controls col-sm-7">
                            <div ng-show="config_var_hints.length">{{ config_var_hints }}</div>
                            <input
                                class="textinput textInput form-control maxwidth500"
                                maxlength="192"
                                name="name"
                                ng-model="edit_obj.name"
                                required="True"
                                type="text"
                                autocomplete="off"
                                uib-typeahead="hint for hint in config_var_hints | filter:$viewValue"
                                typeahead-on-select="var_selected($item, $model, $label)"
                                ng-blur="name_blur()"
                            />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3 requiredField icsw-formlabel">
                            Description<span class="asteriskField">*</span>
                        </label>
                        <div class="controls col-sm-7">
                            <input class="textinput textInput form-control maxwidth500" maxlength="765" name="description" ng-model="edit_obj.description" required="True" type="text"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3 icsw-formlabel">
                            Value
                        </label>
                        <div class="controls col-sm-7" ng-if="var_type == 'str'">
                            <textarea class="textarea form-control maxwidth500" cols="40" name="value" ng-model="edit_obj.value" rows="10"></textarea>
                        </div>
                        <div class="controls col-sm-7" ng-if="var_type == 'int'">
                            <input class="numberinput form-control maxwidth500" name="value" ng-model="edit_obj.value" type="number"/>
                        </div>
                        <div class="controls col-sm-7" ng-if="var_type == 'bool'">
                            <input
                                type="button"
                                ng-class='edit_obj.value && "btn btn-sm btn-success" || "btn btn-sm btn-default"'
                                ng-click="edit_obj.value = 1 - edit_obj.value"
                                ng-value='edit_obj.value && "true" || "false"'
                            />
                        </div>
                    </div>
                </fieldset>
                <div ng-bind-html="edit_obj.$$var_help_html"></div>
            </uib-tab>
            <uib-tab heading="History" ng-if="!create">
                <icsw-history-model-history style="config" icsw-model="model_name" icsw-object-id="edit_obj.idx"></icsw-history-model-history>
            </uib-tab>
        </uib-tabset>
    </form>
</script>
