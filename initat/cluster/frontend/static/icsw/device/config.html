<script type="text/ng-template" id="icsw/main/device/config.html">

    <icsw-device-configuration-overview icsw-sel-man="0" icsw-sel-man-sel-mode="D"></icsw-device-configuration-overview>

    <icsw-config-generate-config icsw-sel-man="0" icsw-sel-man-sel-mode="d"></icsw-config-generate-config>
</script>

<script type="text/ng-template" id="icsw.device.configuration.overview">
    <h2>
        Device config ({{ helper.devices.length }} devices), {{ configs.length }} configurations ({{ helper.active_configs.length }} shown)
    </h2>
    <div class="form-inline">
        <input class="form-control" ng-model="name_filter" placeholder="filter"/>,
        <input
            type="button"
            ng-class="only_selected && 'btn btn-sm btn-success' || 'btn btn-sm'"
            ng-click="toggle_only_selected()"
            value="only selected"
            title="show only configs selected anywhere in the current selection"
        />
        <div class="form-group" ng-show="acl_create(null, 'backbone.config.modify_config') && helper.config_tree.catalog_list.length > 0">
            <input placeholder="new config" ng-model="new_config_name" class="form-control input-sm"/>
            <div class="btn-group" ng-show="new_config_name">
                <button type="button" class="btn btn-sm btn-success dropdown-toggle" data-toggle="dropdown">
                    Create in catalog <span class="caret"></span>
                </button>
                <ul class="dropdown-menu">
                    <li ng-repeat="entry in helper.config_tree.catalog_list" ng-click="create_config(entry)"><a>{{ entry.name }}</a></li>
                </ul>
            </div>
        </div>
    </div>
    <uib-accordion ng-show="helper.devices.length" close-others="false">
        <uib-accordion-group is-open="matrix">
            <uib-accordion-heading>
                <i class="glyphicon" ng-class="{'glyphicon-chevron-down': matrix, 'glyphicon-chevron-right': !matrix}"></i>
                Config matrix
            </uib-accordion-heading>
            <table ng-show="helper.devices.length" class="table table-condensed table-hover" style="width:auto;">
                <thead>
                    <tr>
                        <th colspan="3">&nbsp;</th>
                        <th class="rotate" ng-repeat="conf in helper.active_configs">
                             <div><span>{{ conf.info_str }}</span></div>
                        </th>
                    </tr>
                    <tr>
                        <th>Type</th>
                        <td>local</td>
                        <td>meta</td>
                        <th ng-repeat="conf in active_configs">
                             <span class="badge">{{ conf.config_type_str }}</span>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="dev in helper.devices">
                        <th ng-class="get_th_class(dev)">{{ get_name(dev) }}</th>
                        <td class="text-center">{{ dev.$local_selected.length }}</td>
                        <td class="text-center">
                            <span ng-show="!dev.is_meta_device">{{ dev.$num_meta_selected }}</span>
                        </td>
                        <td icsw-device-configuration-row-data device="dev" helper="helper"></td>
                    </tr>
                </tbody>
            </table>
        </uib-accordion-group>
    </uib-accordion>
</script>
