<script type="text/ng-template" id="icsw/setup/progress">
    <icsw-setup-progress icsw-sel-man="0"></icsw-setup-progress>
</script>


<script type="text/ng-template" id="icsw.setup.progress">
    <style>
        .vertical-align {
            vertical-align: middle !important;
        }
        .a-inherit {
            color:inherit;
            text-decoration: none;
            display:table-cell;
            vertical-align:middle;
        }
    </style>
    <div class="container-fluid" >
        <div
            uib-alert
            class="alert-warning"
            ng-show="!struct.data_loaded"
        >
            Fetching data from server ...
        </div>
        <div ng-if="struct.data_loaded">
            <br/>
            <uib-tabset active="struct.active_tab_index">
                <uib-tab ng-click="setup_tasks_tab_clicked()">
                    <uib-tab-heading>
                        <span>Setup Tasks</span>
                    </uib-tab-heading>

                    <table
                        class="table table-condensed table-hover table-striped"
                    >
                        <thead>
                            <tr>
                                <th style="width: 10px" class="lead">Task</th>
                                <th style="width: 500px" class="lead">Description</th>
                                <th style="width: 10px" class="lead text-center">Status</th>
                                <th style="width: 10px" class="lead text-center" colspan="2">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="task in struct.tasks" class="lead">
                                <td class="vertical-align">
                                    <span class="label label-primary">{{ task.number }}</span>
                                </td>
                                <td class="vertical-align">
                                    {{ task.description }}
                                </td>
                                <td ng-class="task.bg_color_class" class="text-center" ng-click="open_in_new_tab_for_system(task)">
                                    <i ng-class="task.icon_class" style="font-size: 2em !important;"></i>
                                </td>
                                <td class="text-center vertical-align">
                                    <icsw-tools-button
                                        type="modify"
                                        ng-click="open_in_new_tab_for_system(task)"
                                        size="sm"
                                        value="Handle Issue"
                                    ></icsw-tools-button>
                                </td>
                                <td class="text-center vertical-align">
                                    <icsw-tools-button
                                        type="enable"
                                        ng-show="!task.fulfilled"
                                        ng-click="ignore_issue(task)"
                                        is-enable="task.ignore"
                                        size="sm"
                                        icsw-value="task.ignore_text"
                                    ></icsw-tools-button>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                </uib-tab>
                <uib-tab ng-click="system_overview_tab_clicked()">
                    <uib-tab-heading>
                        <span>System Status</span>
                    </uib-tab-heading>
                    <br>
                        <label class="control-label">Component Setup Status:</label>
                    <br/>
                    <div class="container-fluid">
                        <div ng-repeat="task in struct.tasks" class="col-md-4 col-xs-6">
                            <div class="panel" ng-class="task.panel_class">
                                <div class="panel-heading">
                                    <h3 class="panel-title">{{ task.header }}</h3>
                                </div>
                                <div class="panel-body">
                                    <strong>
                                        <a href="" ng-click="open_in_new_tab_for_system(task)">{{ task.text }}</a>
                                        &nbsp;
                                        <i ng-class="task.icon_class"></i>
                                    </strong>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br><label class="control-label">Total System Setup Progress:</label><br/>
                    <div class="progress">
                        <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="40"
                            aria-valuemin="0" aria-valuemax="100" ng-style="{width : ( struct.system_completion + '%' ) }">
                            <span>{{ struct.system_completion }} %</span>
                        </div>
                    </div>
                </uib-tab>
                <uib-tab ng-click="device_overview_tab_clicked()">
                    <uib-tab-heading>
                        <span>Device Status</span>
                    </uib-tab-heading>
                    <br/>
                    <table
                        st-table="entries_displayed"
                        st-safe-src="struct.devices"
                        class="table table-condensed table-striped table-hover simple-border"
                    >

                        <thead>
                            <tr>
                                <td colspan="99">
                                    <span
                                        icsw-tools-pagination
                                        st-items-by-page="20"
                                        st-displayed-pages="11"
                                        possible-items-by-page="10,20,50,100"
                                        class="pull-xs-left"
                                    ></span>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="99">
                                    Show Details (all Devices):
                                    <div class="btn-group btn-group-xs">
                                        <input
                                            type="button"
                                            title="show_extended_information_button"
                                            ng-value="struct.show_extended_information_button_value"
                                            ng-class="struct.show_extended_information_button_class"
                                            ng-click="show_extended_information_button_pressed()">
                                        </input>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th st-sort="name">Name</th>
                                <th st-sort="device_group_name">Group</th>
                                <th st-sort="$$date_created" st-sort-default="reverse">Created at</th>
                                <th>Creator</th>
                                <th class="text-center">Action</th>
                                <th class="text-center" ng-repeat="obj in struct.device_task_headers" st-sort="{{ 'device_status_sort_hint_' + obj[1] }}">{{ obj[0] }}</th>
                                <th st-sort="$$overview_completion_percentage" class="text-center">% Complete</th>
                            </tr>
                            <tr>
                                <th>
                                    <input st-search="name" placeholder="filter by device name" class="input-sm form-control" type="search"/>
                                </th>
                                <th>
                                    <input st-search="device_group_name" placeholder="filter by group" class="input-sm form-control" type="search"/>
                                </th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th ng-repeat="obj in struct.device_task_headers"></th>
                                <th>
                                    <!--
                                    <select st-search="$$overview_completion_percentage">
                                        <option value="">All</option>
                                        <option value="0">0</option>
                                        <option value="25">25</option>
                                        <option value="50">50</option>
                                        <option value="75">75</option>
                                        <option value="100">100</option>
                                    </select>
                                    -->
                                </th>
                            </tr>
                        </thead>

                        <tbody>
                            <tr ng-repeat-start="obj in entries_displayed">
                                <td class="vertical-align">
                                    <button type="button" class="btn btn-xs btn-success" ng-click="show_device($event, obj)">{{ obj.full_name }}</button>
                                </td>
                                <td class="vertical-align">{{ obj.device_group_name }}</td>
                                <td class="vertical-align">{{ obj.$$date_created }}</td>
                                <td class="vertical-align">{{ obj.$$creator }}</td>
                                <td class="vertical-align text-center"><button type="button" class="btn btn-sm btn-primary" ng-click="device_status_show_details(obj)">Show Details</button></td>
                                <td class="text-center" ng-repeat="task in obj.$$device_tasks"><div ng-class="task.table_div_class"><strong><a class="a-inherit" href="" ng-click='open_in_new_tab_for_devices(task, obj)' style="height:25px;">{{ task.table_div_text }}</a></strong></div></td>
                                <td class="vertical-align">
                                    <div class="progress" style="margin-bottom: 0px !important;">
                                        <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="40"
                                            aria-valuemin="0" aria-valuemax="100" ng-style="{width : ( obj.$$overview_completion_percentage + '%' ) }">
                                            <span>{{ obj.$$overview_completion_percentage }}</span>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr ng-repeat-end ng-if="obj.$$device_status_show_details == true">
                                <td colspan="99">
                                    <div class="container-fluid">
                                        <div ng-repeat="task in obj.$$device_tasks" class="col-md-4 col-xs-6">
                                            <br/>
                                            <div class="panel" ng-class="task.panel_class">
                                                <div class="panel-heading">
                                                    <h3 class="panel-title">{{ task.header }}</h3>
                                                </div>
                                                <div class="panel-body">
                                                    <strong>
                                                        <a href="" ng-click="open_in_new_tab_for_devices(task, obj)">{{ task.text }}</a>
                                                        &nbsp;
                                                        <i ng-class="task.icon_class"></i>
                                                        &nbsp;
                                                        <a ng-if="!task.fulfilled" href="" ng-click="ignore_device_issue(task, obj)">{{ task.ignore_text }}</a>
                                                        &nbsp;
                                                        <a ng-if="task.perform_special_action" href="" ng-click="perform_special_action(task, obj)">[{{ task.perform_special_action_text }}]</a>
                                                    </strong>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </uib-tab>
                <uib-tab ng-repeat="tab in struct.tabs" ng-click="mark_unfresh(tab)">
                    <uib-tab-heading>
                        <span>{{ tab.heading }}</span>
                        <icsw-tools-button size="xs" type="close" value="" ng-click="close_tab(tab)"></icsw-tools-button>
                    </uib-tab-heading>
                    <icsw-device-mon-config-overview ng-if="tab.type == 0" icsw-sel-man="1" icsw-select-device="{{ tab.device_id }}"></icsw-device-mon-config-overview>
                    <icsw-device-location-overview ng-if="tab.type == 1" icsw-sel-man="1" icsw-select-device="{{ tab.device_id }}"></icsw-device-location-overview>
                    <icsw-device-asset-overview-reduced ng-if="tab.type == 2" icsw-sel-man="1" icsw-select-device="{{ tab.device_id }}"></icsw-device-asset-overview-reduced>
                    <icsw-rrd-graph-normal ng-if="tab.type == 3" icsw-sel-man="1" icsw-select-device="{{ tab.device_id }}"></icsw-rrd-graph-normal>
                    <icsw-device-tree-overview ng-if="tab.type == 4 && tab.devices_available == true"></icsw-device-tree-overview>
                    <icsw-device-create-mask ng-if="tab.type == 4 && tab.devices_available == false"></icsw-device-create-mask>
                    <br ng-if="tab.type == 5"/><icsw-config-moncheck-overview ng-if="tab.type == 5"></icsw-config-moncheck-overview>
                    <br ng-if="tab.type == 6"/><icsw-user-tree ng-if="tab.type == 6"></icsw-user-tree>
                    <br ng-if="tab.type == 7"/><icsw-config-location ng-if="tab.type == 7"></icsw-config-location>
                    <icsw-config-category-tree-edit ng-if="tab.type == 8" mode="device"></icsw-config-category-tree-edit>
                </uib-tab>
            </uib-tabset>
        </div>
    </div>
</script>
